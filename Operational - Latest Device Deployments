IntuneOperationalLogs 
| extend DeviceId = tostring(todynamic(Properties).IntuneDeviceId)
| extend OS = tostring(todynamic(Properties).Os)
| where Result == "Success"
| where OperationName has "Enrollment"
| where OS == "Windows"
| join kind=leftouter IntuneDevices on DeviceId // DeviceName from IntuneDevices
| project TimeGenerated, DeviceId, DeviceName, Result, OperationName, OS
| summarize TimeGenerated = max(TimeGenerated) by DeviceId, DeviceName, Result, OperationName, OS
| sort by TimeGenerated desc
